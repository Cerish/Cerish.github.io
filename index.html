<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="Jay Lee个人博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Jay Lee个人博客">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jay Lee个人博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>Jay Lee个人博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jay Lee个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/08/hexo-cli/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jay Lee">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jay Lee个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/08/hexo-cli/" itemprop="url">利用 hexo + github 搭建属于自己的个人网站</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-08T17:26:11+08:00">
                2019-09-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>作为前端小白的我，在之前项目中遇到问题，一直都是 百度–解决–完事。在一次偶然的机会接触到 <a href="http://www.markdown.cn/" target="_blank" rel="noopener">Markdown</a>，知道博客也是有Markdown 语法生成。再加上看到过有大佬的项目为 https:username/github.io/username。两者一结合，那我也生成一个自己的博客吧！虽然百度上有很多大佬写的教程，但是自己也做个记录，当做知识点记载吧。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/09/08/hexo-cli/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/23/待了解的原理探索/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jay Lee">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jay Lee个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/08/23/待了解的原理探索/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-23T14:18:08+08:00">
                2020-08-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>mybatis 底层原理</li>
<li>redis 底层原理</li>
<li>注解生效原理</li>
<li>泛型是如何实现的</li>
<li>mysql 索引原理及优化</li>
<li>I/O 操作</li>
<li>并发 锁</li>
</ul>
<ul>
<li>游客 –&gt; 首页 gdpu 用户设置</li>
<li>学生 –&gt; 首页  查看自己班级的排课表 查看自己的成绩</li>
<li>老师 –&gt; 首页 查看自己班级的</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/19/springboot 多线程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jay Lee">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jay Lee个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/08/19/springboot 多线程/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-19T18:29:02+08:00">
                2020-08-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="springboot-多线程"><a href="#springboot-多线程" class="headerlink" title="springboot 多线程"></a>springboot 多线程</h1><ul>
<li>Spring是通过任务执行器(TaskExecutor)来实现多线程和并发编程，使用ThreadPoolTaskExecutor来创建一个基于线城池的TaskExecutor。在使用线程池的大多数情况下都是异步非阻塞的。我们配置注解<code>@EnableAsync</code>可以开启异步任务。然后在实际执行的方法上配置注解<code>@Async</code>上声明是异步任务。</li>
</ul>
<h2 id="1-配置类"><a href="#1-配置类" class="headerlink" title="1. 配置类"></a>1. 配置类</h2><ul>
<li>首先在==启动类==上使用<code>@EnableAsync</code>来开启Springboot对于异步任务的支持。</li>
<li>配置类实现接口AsyncConfigurator，返回一个ThreadPoolTaskExecutor线程池对象。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.interceptor.AsyncUncaughtExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.AsyncConfigurer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.EnableAsync;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executor;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ThreadPoolExecutor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableAsync</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncTaskConfig</span> <span class="keyword">implements</span> <span class="title">AsyncConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ThredPoolTaskExcutor的处理流程</span></span><br><span class="line">    <span class="comment">// 当池子大小小于corePoolSize，就新建线程，并处理请求</span></span><br><span class="line">    <span class="comment">// 当池子大小等于corePoolSize，把请求放入workQueue中，池子里的空闲线程就去workQueue中取任务并处理</span></span><br><span class="line">    <span class="comment">// 当workQueue放不下任务时，就新建线程入池，并处理请求，如果池子大小撑到了maximumPoolSize，就用RejectedExecutionHandler来做拒绝处理</span></span><br><span class="line">    <span class="comment">// 当池子的线程数大于corePoolSize时，多余的线程会等待keepAliveTime长时间，如果无请求可处理就自行销毁</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Executor <span class="title">getAsyncExecutor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ThreadPoolTaskExecutor executor = <span class="keyword">new</span> ThreadPoolTaskExecutor();</span><br><span class="line">        <span class="comment">//设置核心线程数</span></span><br><span class="line">        executor.setCorePoolSize(<span class="number">10</span>);</span><br><span class="line">        <span class="comment">//设置最大线程数</span></span><br><span class="line">        executor.setMaxPoolSize(<span class="number">100</span>);</span><br><span class="line">        <span class="comment">//线程池所使用的缓冲队列</span></span><br><span class="line">        executor.setQueueCapacity(<span class="number">100</span>);</span><br><span class="line">        <span class="comment">//等待任务在关机时完成--表明等待所有线程执行完</span></span><br><span class="line">        executor.setWaitForTasksToCompleteOnShutdown(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 等待时间 （默认为0，此时立即停止），并没等待xx秒后强制停止</span></span><br><span class="line">        executor.setAwaitTerminationSeconds(<span class="number">60</span>);</span><br><span class="line">        <span class="comment">//  线程名称前缀</span></span><br><span class="line">        executor.setThreadNamePrefix(<span class="string">"Tiro-Async-"</span>);</span><br><span class="line">        <span class="comment">// 设置超出祖达线程数时，等待新的空闲线程</span></span><br><span class="line">        executor.setRejectedExecutionHandler(<span class="keyword">new</span> ThreadPoolExecutor.CallerRunsPolicy());</span><br><span class="line">        <span class="comment">// 初始化线程</span></span><br><span class="line">        executor.initialize();</span><br><span class="line">        <span class="keyword">return</span> executor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AsyncUncaughtExceptionHandler <span class="title">getAsyncUncaughtExceptionHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-基于-Async"><a href="#2-基于-Async" class="headerlink" title="2. 基于@Async"></a>2. 基于@Async</h2><ul>
<li>无返回值的调用： 直接在类或方法上添加注解@async<ul>
<li>在方法上添加，则表示该方法是异步任务</li>
<li>在类上添加，则表示该类的所有方法是异步任务</li>
</ul>
</li>
<li>有返回值的调用<ul>
<li>返回值为future接口的泛型，装载返回的数据类型，然后返回时，new AsyncResult();</li>
<li>AsyncResult –&gt;  implements ListenableFuture<v> –&gt; extends Future<t> </t></v></li>
</ul>
</li>
</ul>
<h2 id="3-可能出现的问题"><a href="#3-可能出现的问题" class="headerlink" title="3. 可能出现的问题"></a>3. 可能出现的问题</h2><h3 id="3-1-因为设置了-setMaxPoolSize-线程最大值，-所有可能会出现AsyncExecutionInterceptor-报错？"><a href="#3-1-因为设置了-setMaxPoolSize-线程最大值，-所有可能会出现AsyncExecutionInterceptor-报错？" class="headerlink" title="3.1 因为设置了 setMaxPoolSize 线程最大值， 所有可能会出现AsyncExecutionInterceptor 报错？"></a>3.1 因为设置了 setMaxPoolSize 线程最大值， 所有可能会出现AsyncExecutionInterceptor 报错？</h3><ul>
<li>设置setRejectedExecutionHandler 处理器， 将报该错的线程等待空闲线程</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());</span><br></pre></td></tr></table></figure>

<ul>
<li>不设置缓存队列</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">executor.setQueueCapacity(100);</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/17/rabbitmq学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jay Lee">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jay Lee个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/08/17/rabbitmq学习/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-17T13:48:30+08:00">
                2020-08-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="rabbbitmq-学习"><a href="#rabbbitmq-学习" class="headerlink" title="rabbbitmq 学习"></a>rabbbitmq 学习</h1><h2 id="1-安装Erlang"><a href="#1-安装Erlang" class="headerlink" title="1. 安装Erlang"></a>1. 安装Erlang</h2><ul>
<li>RabbitMQ服务端代码是使用并发式语言Erlang编写的，安装Rabbit MQ的前提是安装Erlang。</li>
<li>下载地址：<a href="http://www.erlang.org/downloads" target="_blank" rel="noopener">http://www.erlang.org/downloads</a></li>
<li>安装完成之后，配置环境变量，在命令行输入 <code>erl</code>查看是否安装成功。</li>
</ul>
<h2 id="2-安装rabbitmq"><a href="#2-安装rabbitmq" class="headerlink" title="2. 安装rabbitmq"></a>2. 安装rabbitmq</h2><ul>
<li>下载地址：<a href="http://www.rabbitmq.com/download.html" target="_blank" rel="noopener">http://www.rabbitmq.com/download.html</a></li>
<li>进入sbin目录，安装可视化插件 <code>rabbitmq-plugins enable rabbitmq_management</code></li>
</ul>
<blockquote>
<p>若server.bat 启动闪退，依次执行以下命令</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rabbitmq-service.bat remove</span><br><span class="line"># 你下载的版本号</span><br><span class="line">set RABBITMQ_BASE=D:\install3\rabbitmq\rabbitmq_server-3.7.14\data </span><br><span class="line">rabbitmq-service.bat install</span><br><span class="line">rabbitmq-plugins enable rabbitmq_management</span><br><span class="line">net start rabbitmq</span><br></pre></td></tr></table></figure>

<h2 id="3-springboot-整合-rabbitmq"><a href="#3-springboot-整合-rabbitmq" class="headerlink" title="3. springboot 整合 rabbitmq"></a>3. springboot 整合 rabbitmq</h2><ul>
<li>在pom.xml中引入如下依赖内容，其中spring-boot-starter-amqp用于支持 RabbitMQ。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- rabbitmq --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在配置文件中配置关于RabbitMQ的连接和用户信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  rabbitmq:</span><br><span class="line">    password: guest</span><br><span class="line">    username: guest</span><br><span class="line">    port: 5672</span><br><span class="line">    addresses: 127.0.0.1</span><br><span class="line">    #开启发送失败返回</span><br><span class="line">    publisher-returns: true</span><br><span class="line">    #开启发送确认</span><br><span class="line">    publisher-confirms: true</span><br><span class="line">    listener:</span><br><span class="line">      simple:</span><br><span class="line">        #指定最小的消费者数量.</span><br><span class="line">        concurrency: 2</span><br><span class="line">        #指定最大的消费者数量.</span><br><span class="line">        max-concurrency: 2</span><br><span class="line">        #开启ack</span><br><span class="line">        acknowledge-mode: auto</span><br><span class="line">      #开启ack</span><br><span class="line">      direct:</span><br><span class="line">        acknowledge-mode: auto</span><br><span class="line">    #支持消息的确认与返回</span><br><span class="line">    template:</span><br><span class="line">      mandatory: true</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/10/spring security认证流程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jay Lee">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jay Lee个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/08/10/spring security认证流程/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-10T22:16:41+08:00">
                2020-08-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="spring-security-认证流程"><a href="#spring-security-认证流程" class="headerlink" title="spring security 认证流程"></a>spring security 认证流程</h1><h2 id="1-默认-认证流程"><a href="#1-默认-认证流程" class="headerlink" title="1. 默认 认证流程"></a>1. 默认 认证流程</h2><h3 id="1-1-获取用户传来的信息"><a href="#1-1-获取用户传来的信息" class="headerlink" title="1.1 获取用户传来的信息"></a>1.1 获取用户传来的信息</h3><ul>
<li>用户输入的账号密码等信息，这些东西其实就是用户的认证信息，对应到 Spring Security 中的话就是 <code>Authentication</code> 对象，只不过，Spring Security 中的 Authentication 对象除了保存用户的认证信息以外， 还可以用来保存用户认证成功后从数据库中拿到的用户的详细信息。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Authentication</span> <span class="keyword">extends</span> <span class="title">Principal</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">  Collection&lt;? extends GrantedAuthority&gt; getAuthorities();  <span class="comment">// 用户权限</span></span><br><span class="line">  <span class="function">Object <span class="title">getCredentials</span><span class="params">()</span></span>;                                  <span class="comment">// 用户认证信息</span></span><br><span class="line">  <span class="function">Object <span class="title">getDetails</span><span class="params">()</span></span>;                                      <span class="comment">// 用户详细信息</span></span><br><span class="line">  <span class="function">Object <span class="title">getPrincipal</span><span class="params">()</span></span>;                                    <span class="comment">// 用户身份信息</span></span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">isAuthenticated</span><span class="params">()</span></span>;           <span class="comment">// 当前 Authentication 是否已认证</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">setAuthenticated</span><span class="params">(<span class="keyword">boolean</span> isAuthenticated)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-数据库存储的信息"><a href="#1-2-数据库存储的信息" class="headerlink" title="1.2 数据库存储的信息"></a>1.2 数据库存储的信息</h3><ul>
<li>只凭用户提供的认证信息往往是不足以用来判断该用户是否合法的，因此，我们通常还需要某种手段来获取保存在服务端的用户信息，同时，也需要某种手段来保存用户信息， 这些对应到 Spring Security 中的话就是 <code>UserDetailsService</code> 和 <code>UserDetails</code> 这两个对象。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDetailsService</span> </span>&#123;</span><br><span class="line">  <span class="function">UserDetails <span class="title">loadUserByUsername</span><span class="params">(String username)</span> <span class="keyword">throws</span> UsernameNotFoundException</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDetails</span> <span class="keyword">extends</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">  Collection&lt;? extends GrantedAuthority&gt; getAuthorities();</span><br><span class="line">  <span class="function">String <span class="title">getPassword</span><span class="params">()</span></span>; </span><br><span class="line">  <span class="function">String <span class="title">getUsername</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">isAccountNonExpired</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">isAccountNonLocked</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">isCredentialsNonExpired</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">isEnabled</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-比对信息"><a href="#1-3-比对信息" class="headerlink" title="1.3 比对信息"></a>1.3 比对信息</h3><ul>
<li>在拥有了用户提供的认证信息和保存在服务端的用户信息后，我们就需要通过某种方式来比较这两份信息，而这种来效验用户认证信息的对象对应到 Spring Security 中便是 <code>AuthenticationManager</code> 对象了。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AuthenticationProvider</span> </span>&#123;</span><br><span class="line">  <span class="function">Authentication <span class="title">authenticate</span><span class="params">(Authentication authentication)</span> <span class="keyword">throws</span> AuthenticationException</span>;</span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Class&lt;?&gt; authentication)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200810235912012.png" alt="image-20200810235912012"></p>
<h2 id="2-自定义认证流程"><a href="#2-自定义认证流程" class="headerlink" title="2. 自定义认证流程"></a>2. 自定义认证流程</h2><h3 id="2-1-新建一个存储认证信息的token"><a href="#2-1-新建一个存储认证信息的token" class="headerlink" title="2.1 新建一个存储认证信息的token"></a>2.1 新建一个存储认证信息的token</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.cerish.filter.mobileCodeLogin;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.security.authentication.AbstractAuthenticationToken;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.GrantedAuthority;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.SpringSecurityCoreVersion;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MobileCodeAuthenticationToken</span> <span class="keyword">extends</span> <span class="title">AbstractAuthenticationToken</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = SpringSecurityCoreVersion.SERIAL_VERSION_UID;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Object principal;</span><br><span class="line">    <span class="keyword">private</span> Object credentials;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MobileCodeAuthenticationToken</span><span class="params">(Object principal, Object credentials)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">this</span>.principal = principal;</span><br><span class="line">        <span class="keyword">this</span>.credentials = credentials;</span><br><span class="line">        setAuthenticated(<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MobileCodeAuthenticationToken</span><span class="params">(Object principal,Object credentials,</span></span></span><br><span class="line"><span class="function"><span class="params">                                      Collection&lt;? extends GrantedAuthority&gt; authorities)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(authorities);</span><br><span class="line">        <span class="keyword">this</span>.principal = principal;</span><br><span class="line">        <span class="keyword">this</span>.credentials = credentials;</span><br><span class="line">        <span class="keyword">super</span>.setAuthenticated(<span class="keyword">true</span>); <span class="comment">// must use super, as we override</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getCredentials</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getPrincipal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.principal;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAuthenticated</span><span class="params">(<span class="keyword">boolean</span> isAuthenticated)</span> <span class="keyword">throws</span> IllegalArgumentException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (isAuthenticated) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">                    <span class="string">"Cannot set this token to trusted - use constructor which takes a GrantedAuthority list instead"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">super</span>.setAuthenticated(<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eraseCredentials</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.eraseCredentials();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-新建-provider-重写-authenticate-判断"><a href="#2-2-新建-provider-重写-authenticate-判断" class="headerlink" title="2.2 新建 provider 重写 authenticate 判断"></a>2.2 新建 provider 重写 authenticate 判断</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.cerish.filter.mobileCodeLogin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.security.authentication.AuthenticationProvider;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.authentication.BadCredentialsException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.Authentication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.GrantedAuthority;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.authority.SimpleGrantedAuthority;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MobileCodeAuthenticationProvider</span> <span class="keyword">implements</span> <span class="title">AuthenticationProvider</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Authentication <span class="title">authenticate</span><span class="params">(Authentication authentication)</span> <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">        String mobile = (authentication.getPrincipal() == <span class="keyword">null</span>) ? <span class="string">"NONE_PROVIDED"</span> : authentication.getName();</span><br><span class="line">        String code = (String) authentication.getCredentials();</span><br><span class="line">        <span class="keyword">if</span> (code == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BadCredentialsException(<span class="string">"验证码不能为空"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="string">"15398868007"</span>.equals(mobile)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BadCredentialsException(<span class="string">"用户不存在"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 手机号验证码业务还没有开发，先用4个0验证</span></span><br><span class="line">        <span class="keyword">if</span> (!code.equals(<span class="string">"0000"</span>)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BadCredentialsException(<span class="string">"验证码不正确"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        MobileCodeAuthenticationToken result = <span class="keyword">new</span> MobileCodeAuthenticationToken(mobile,</span><br><span class="line">                listUserGrantedAuthorities(mobile));</span><br><span class="line">        result.setDetails(authentication.getDetails());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Class&lt;?&gt; authentication)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (MobileCodeAuthenticationToken.class.isAssignableFrom(authentication));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Set&lt;GrantedAuthority&gt; <span class="title">listUserGrantedAuthorities</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        Set&lt;GrantedAuthority&gt; authorities = <span class="keyword">new</span> HashSet&lt;GrantedAuthority&gt;();</span><br><span class="line">        <span class="keyword">if</span> (username == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> authorities;</span><br><span class="line">        &#125;</span><br><span class="line">        authorities.add(<span class="keyword">new</span> SimpleGrantedAuthority(<span class="string">"ROLE_USER"</span>));</span><br><span class="line">        <span class="keyword">return</span> authorities;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-新建一个-filter"><a href="#2-3-新建一个-filter" class="headerlink" title="2.3 新建一个 filter"></a>2.3 新建一个 filter</h3><ul>
<li>在这里，可定义该 过滤器所需要的的字段</li>
<li>AntPathRequestMatcher 定义过滤器拦截的 URI</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.cerish.filter.mobileCodeLogin;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.lang.Nullable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.authentication.AuthenticationServiceException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.Authentication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.util.matcher.AntPathRequestMatcher;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MobileAuthenticationProcessingFilter</span> <span class="keyword">extends</span> <span class="title">AbstractAuthenticationProcessingFilter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SPRING_SECURITY_FORM_MOBILE_KEY = <span class="string">"mobile"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SPRING_SECURITY_FORM_CODE_KEY = <span class="string">"code"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String mobileParameter = SPRING_SECURITY_FORM_MOBILE_KEY;</span><br><span class="line">    <span class="keyword">private</span> String codeParameter = SPRING_SECURITY_FORM_CODE_KEY;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> postOnly = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MobileAuthenticationProcessingFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="keyword">new</span> AntPathRequestMatcher(<span class="string">"/login"</span>, <span class="string">"POST"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Authentication <span class="title">attemptAuthentication</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> AuthenticationException, IOException, ServletException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (postOnly &amp;&amp; !request.getMethod().equals(<span class="string">"POST"</span>)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> AuthenticationServiceException(</span><br><span class="line">                    <span class="string">"Authentication method not supported: "</span> + request.getMethod());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String mobile = obtainMobile(request);</span><br><span class="line">        String code = obtainCode(request);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (mobile == <span class="keyword">null</span>) &#123;</span><br><span class="line">            mobile = <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (code == <span class="keyword">null</span>) &#123;</span><br><span class="line">            code = <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        mobile = mobile.trim();</span><br><span class="line"></span><br><span class="line">        MobileCodeAuthenticationToken authRequest = <span class="keyword">new</span> MobileCodeAuthenticationToken(</span><br><span class="line">                mobile, code, <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Allow subclasses to set the "details" property</span></span><br><span class="line">        setDetails(request, authRequest);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.getAuthenticationManager().authenticate(authRequest);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> String <span class="title">obtainMobile</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request.getParameter(mobileParameter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> String <span class="title">obtainCode</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> request.getParameter(codeParameter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setDetails</span><span class="params">(HttpServletRequest request,</span></span></span><br><span class="line"><span class="function"><span class="params">                              MobileCodeAuthenticationToken authRequest)</span> </span>&#123;</span><br><span class="line">        authRequest.setDetails(authenticationDetailsSource.buildDetails(request));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-总结"><a href="#2-4-总结" class="headerlink" title="2.4 总结"></a>2.4 总结</h3><ul>
<li>定义一个拦截URI的过滤器</li>
<li>定义provider 重写 authenticate 规则</li>
<li>定义 token 存储认证后的信息</li>
<li>使用默认的 AuthenticationManager </li>
<li>坏处： 每一次请求都会经过该filter， 而需求是登录api才拦截。</li>
</ul>
<h2 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h2><h2 id="4-filter-链"><a href="#4-filter-链" class="headerlink" title="4. filter 链"></a>4. filter 链</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> SecurityContextPersistenceFilter</span><br><span class="line">-&gt;HeaderWriterFilter</span><br><span class="line">-&gt;LogoutFilter</span><br><span class="line">-&gt;UsernamePasswordAuthenticationFilter</span><br><span class="line">-&gt;RequestCacheAwareFilter</span><br><span class="line">-&gt;SecurityContextHolderAwareRequestFilter</span><br><span class="line">-&gt;SessionManagementFilter</span><br><span class="line">-&gt;ExceptionTranslationFilter</span><br><span class="line">-&gt;FilterSecurityInterceptor</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/20/vue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jay Lee">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jay Lee个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/20/vue/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-20T12:29:37+08:00">
                2020-07-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="常见vue问题"><a href="#常见vue问题" class="headerlink" title="常见vue问题"></a>常见vue问题</h1><h2 id="1-vue-router"><a href="#1-vue-router" class="headerlink" title="1. vue router"></a>1. vue router</h2><h3 id="1-1-懒加载问题"><a href="#1-1-懒加载问题" class="headerlink" title="1.1 懒加载问题"></a>1.1 懒加载问题</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以下方式可进行懒加载</span></span><br><span class="line"><span class="comment">// 1. 直接在 component 引入</span></span><br><span class="line">component: <span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">require</span>([./Foo], resolve)</span><br><span class="line"><span class="comment">// 2. webpack ensure引入, 很少使用</span></span><br><span class="line"><span class="keyword">const</span> Demo = <span class="function"><span class="params">r</span> =&gt;</span> <span class="built_in">require</span>.ensure([], () =&gt; r(<span class="built_in">require</span>(<span class="string">'../views/Demo'</span>)), <span class="string">'Demo'</span>)</span><br><span class="line"><span class="comment">// 3. es6 变量方式引入 (组件按组分块)</span></span><br><span class="line"><span class="keyword">const</span> Foo = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="comment">/*webpackChunkName:'Home'*/</span> <span class="string">'./Foo'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="1-2-动态路由加载"><a href="#1-2-动态路由加载" class="headerlink" title="1.2 动态路由加载"></a>1.2 动态路由加载</h3><ul>
<li><p>利用 <code>router.addRoutes</code> 可进行路由的动态加载。</p>
</li>
<li><p>==注意点==如下</p>
<ul>
<li><p>不要在全局路由（静态）中定义 <code>{path: &#39;*&#39;, redirect: &#39;/404&#39;}</code>，否则在加载动态路由之前，会直接跳转到 <code>&#39;/404&#39;</code>页面</p>
</li>
<li><p>由于浏览器刷新页面的行为会初始化 router 、vuex等数据，所以需要在 <code>router.beforeEach</code>中进行动态路由的加载</p>
</li>
<li><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据不同的需求进行逻辑切换</span></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(to.meta) &#123;</span><br><span class="line">        <span class="built_in">document</span>.title = to.meta.title;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(store.getters.addRouters.length)</span><br><span class="line">    <span class="keyword">if</span>(!store.getters.addRouters.length) &#123;</span><br><span class="line">        store.dispatch(<span class="string">'GenerateRouterByRoleType'</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            router.addRoutes(store.getters.addRouters);</span><br><span class="line">            next(&#123; ...to, <span class="attr">replace</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// store.dispatch('SET_ROUTERS');</span></span><br><span class="line">        <span class="comment">// router.addRoutes(store.getters.addRouters);</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(localStorage.getItem(<span class="string">"token"</span>)) &#123;</span><br><span class="line">        next();</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 白名单不需要认证</span></span><br><span class="line">        <span class="keyword">if</span> (whiteList.indexOf(to.path) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            next();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            router.replace(<span class="string">'/login'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





</li>
</ul>
</li>
</ul>
<h2 id="2-vuex"><a href="#2-vuex" class="headerlink" title="2. vuex"></a>2. vuex</h2><ul>
<li>常规的vuex 使用包含以下四种，<code>state、 getter、actions、mutations</code></li>
</ul>
<h3 id="2-1-state"><a href="#2-1-state" class="headerlink" title="2.1 state"></a>2.1 state</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// state 一般用于存储属性，作为数据源的存在</span></span><br><span class="line"><span class="comment">// 组件中获取数据的方式</span></span><br><span class="line"><span class="comment">// 1. 直接通过实例获取</span></span><br><span class="line"><span class="keyword">let</span> num = <span class="keyword">this</span>.$store.state.XXX;</span><br><span class="line"><span class="comment">//2. 通过辅助函数获取</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line">computed: &#123;</span><br><span class="line">	mapState(&#123;</span><br><span class="line">        <span class="comment">// 箭头函数可使代码更简练</span></span><br><span class="line">        count: <span class="function"><span class="params">state</span> =&gt;</span> state.count,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 传字符串参数 'count' 等同于 `state =&gt; state.count`</span></span><br><span class="line">        countAlias: <span class="string">'count'</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 为了能够使用 `this` 获取局部状态，必须使用常规函数</span></span><br><span class="line">        countPlusLocalState (state) &#123;</span><br><span class="line">          <span class="keyword">return</span> state.count + <span class="keyword">this</span>.localCount</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-getter"><a href="#2-2-getter" class="headerlink" title="2.2 getter"></a>2.2 getter</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getters 一般用于计算属性</span></span><br><span class="line"><span class="comment">// Getter 也可以接受其他 getter 作为第二个参数</span></span><br><span class="line">getters: &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  doneTodosCount: <span class="function">(<span class="params">state, getters</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> getters.doneTodos.length</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 返回一个方法，可传参数使用</span></span><br><span class="line">  getTodoById: <span class="function">(<span class="params">state</span>) =&gt;</span> <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> state.todos.find(<span class="function"><span class="params">todo</span> =&gt;</span> todo.id === id)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">import</span> &#123; mapGetters &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"><span class="comment">// 组件中获取数据的方式</span></span><br><span class="line"><span class="comment">// 1. 直接通过实例获取</span></span><br><span class="line"><span class="keyword">let</span> num = <span class="keyword">this</span>.$store.getters.XXX;</span><br><span class="line"><span class="comment">//2. 通过辅助函数获取</span></span><br><span class="line">computed: &#123;</span><br><span class="line">    mapGetters(&#123;</span><br><span class="line">      <span class="comment">// 把 `this.doneCount` 映射为 `this.$store.getters.doneTodosCount`</span></span><br><span class="line">      doneCount: <span class="string">'doneTodosCount'</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-mutations"><a href="#2-3-mutations" class="headerlink" title="2.3 mutations"></a>2.3 mutations</h3><blockquote>
<p> <strong>更改 Vuex 的 store 中的状态的唯一方法是提交 mutation。</strong></p>
</blockquote>
<ul>
<li>使用 commit 提交 mutation， mutation改变值得方式只能是同步操作。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mutations: &#123;</span><br><span class="line">    increment (state,value) &#123; </span><br><span class="line">      <span class="comment">// 变更状态</span></span><br><span class="line">      state.count++</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 出发 increment 的方式</span></span><br><span class="line"><span class="comment">// 1. 以载荷形式分发</span></span><br><span class="line">store.commit(<span class="string">'increment'</span>, &#123;</span><br><span class="line">  amount: <span class="number">10</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 2. 以对象形式分发</span></span><br><span class="line">store.commit(&#123;</span><br><span class="line">  type: <span class="string">'increment'</span>,</span><br><span class="line">  amount: <span class="number">10</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="2-4-actions"><a href="#2-4-actions" class="headerlink" title="2.4 actions"></a>2.4 actions</h3><blockquote>
<p> 可以给组件使用的函数，以此用来驱动事件处理器 mutations，==异步操作==</p>
</blockquote>
<blockquote>
<p>使用 dispatch 提交 actions， actions改变值得方式支持操作。可搭配 async/await 使用</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state) &#123;</span><br><span class="line">      state.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    increment (context) &#123;  <span class="comment">//context 执行的上下文，作为第一个参数</span></span><br><span class="line">      context.commit(<span class="string">'increment'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//Action 函数接受一个与 store 实例具有相同方法和属性的 context 对象，因此你可以调用 context.commit 提交一个 mutation，或者通过 context.state 和 context.getters 来获取 state 和 getters。</span></span><br><span class="line"><span class="comment">//需要调用 commit 很多次的时候,可以简写成:</span></span><br><span class="line">actions: &#123;</span><br><span class="line">  increment (&#123; commit &#125;) &#123;</span><br><span class="line">    commit(<span class="string">'increment'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 可调用 actions 中的其他方法</span></span><br><span class="line">actions: &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  actionB (&#123; dispatch, commit &#125;) &#123;</span><br><span class="line">    <span class="keyword">return</span> dispatch(<span class="string">'actionA'</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      commit(<span class="string">'someOtherMutation'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-5-Module"><a href="#2-5-Module" class="headerlink" title="2.5 Module"></a>2.5 Module</h3><blockquote>
<p>由于使用单一状态树，应用的所有状态会集中到一个比较大的对象。当应用变得非常复杂时，store 对象就有可能变得相当臃肿。 </p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可将数据分成 各个独立的模块，包含store的所有方法</span></span><br><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  state: &#123; ... &#125;,</span><br><span class="line">  mutations: &#123; ... &#125;,</span><br><span class="line">  actions: &#123; ... &#125;,</span><br><span class="line">  getters: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 对于模块内部的 action，局部状态通过 context.state 暴露出来，根节点状态则为 context.rootState</span></span><br><span class="line">actions: &#123;</span><br><span class="line">    incrementIfOddOnRootSum (&#123; state, commit, rootState &#125;) &#123;</span><br><span class="line">      <span class="keyword">if</span> ((state.count + rootState.count) % <span class="number">2</span> === <span class="number">1</span>) &#123;</span><br><span class="line">        commit(<span class="string">'increment'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-6-实际的应用案例"><a href="#2-6-实际的应用案例" class="headerlink" title="2.6  实际的应用案例"></a>2.6  实际的应用案例</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> app <span class="keyword">from</span> <span class="string">'./config/app'</span></span><br><span class="line"><span class="keyword">import</span> config <span class="keyword">from</span> <span class="string">'./config/config'</span></span><br><span class="line"><span class="keyword">import</span> errorLog <span class="keyword">from</span> <span class="string">'./config/errorLog'</span></span><br><span class="line"><span class="keyword">import</span> tagsView <span class="keyword">from</span> <span class="string">'./config/tagsView'</span></span><br><span class="line"><span class="keyword">import</span> user <span class="keyword">from</span> <span class="string">'./config/user'</span></span><br><span class="line"><span class="keyword">import</span> permission <span class="keyword">from</span> <span class="string">'./config/permission'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> getters <span class="keyword">from</span> <span class="string">'./getters'</span></span><br><span class="line"><span class="keyword">import</span> mutations <span class="keyword">from</span> <span class="string">'./mutations'</span></span><br><span class="line"><span class="keyword">import</span> actions <span class="keyword">from</span> <span class="string">'./actions'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    modules: &#123;</span><br><span class="line">        app,</span><br><span class="line">        config,</span><br><span class="line">        errorLog,</span><br><span class="line">        tagsView,</span><br><span class="line">        user,</span><br><span class="line">        permission</span><br><span class="line">    &#125;,</span><br><span class="line">    state: &#123;</span><br><span class="line">        routes: []</span><br><span class="line">    &#125;,</span><br><span class="line">    getters,</span><br><span class="line">    mutations,</span><br><span class="line">    actions</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 响应式的更改某个state的值</span></span><br><span class="line"><span class="comment">// store.watch(</span></span><br><span class="line"><span class="comment">//      (state) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//         return state.sessions</span></span><br><span class="line"><span class="comment">//     &#125;, </span></span><br><span class="line"><span class="comment">//     (val) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//         console.log(12312315156)</span></span><br><span class="line"><span class="comment">//         // localStorage.setItem('vue-chat-session', JSON.stringify(val));</span></span><br><span class="line"><span class="comment">//     &#125;, &#123;</span></span><br><span class="line"><span class="comment">//     deep: true/*这个貌似是开启watch监测的判断,官方说明也比较模糊*/</span></span><br><span class="line"><span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>

<h2 id="3-动态监听-localStorage-的变化"><a href="#3-动态监听-localStorage-的变化" class="headerlink" title="3 动态监听 localStorage 的变化"></a>3 动态监听 localStorage 的变化</h2><ul>
<li>在 vuex state 的 使用了 localStorage 的值， 但改变了localStorage 值，需要页面刷新才能获取最新的值。</li>
<li>原理： 在存储值的时候，添加一个监听事件，在获取值的组件 设置监听函数，已实现动态的变化。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/16/常用api/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jay Lee">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jay Lee个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/16/常用api/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-16T15:57:47+08:00">
                2020-07-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="记录一些常用的Api"><a href="#记录一些常用的Api" class="headerlink" title="记录一些常用的Api"></a>记录一些常用的Api</h1><h2 id="1-StringUtil"><a href="#1-StringUtil" class="headerlink" title="1. StringUtil"></a>1. StringUtil</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断类：</span></span><br><span class="line">   <span class="comment">// boolean isEmpty(Object str):字符串是否为空或者空字符串：""</span></span><br><span class="line">   <span class="comment">// boolean hasLength(CharSequence str):字符串是否为空，或者长度为0</span></span><br><span class="line">   <span class="comment">// boolean hasText(String str):字符串是否有内容（不为空，且不全为空格）</span></span><br><span class="line">   assertFalse(StringUtils.hasText(<span class="string">"   "</span>));</span><br><span class="line">   <span class="comment">// boolean containsWhitespace(String str):字符串是否包含空格</span></span><br><span class="line">   assertTrue(StringUtils.containsWhitespace(<span class="string">"a b"</span>));</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/13/redis学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jay Lee">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jay Lee个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/13/redis学习/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-13T14:22:11+08:00">
                2020-07-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="redis-学习"><a href="#redis-学习" class="headerlink" title="redis 学习"></a>redis 学习</h1><h2 id="1-1-redis-常用语句"><a href="#1-1-redis-常用语句" class="headerlink" title="1.1 redis 常用语句"></a>1.1 redis 常用语句</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 查看当前数据库 所有未过期的key</span><br><span class="line">keys *</span><br><span class="line"><span class="meta">#</span> 设置 key 的有效时间 单位是 秒</span><br><span class="line">expire key 10</span><br><span class="line"><span class="meta">#</span> 查看某个键的剩余有效时间： -1 表示没有过期时间（一直有效） -2表示已过期</span><br><span class="line">ttl key</span><br></pre></td></tr></table></figure>

<h2 id="2-linux-上的服务器"><a href="#2-linux-上的服务器" class="headerlink" title="2. linux 上的服务器"></a>2. linux 上的服务器</h2><ul>
<li>服务器本体若启动了redis，则docker容器的redis会报端口占用，停掉本体的redis即可。<code>/etc/init.d/redis-server stop</code></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/06/sql语句/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jay Lee">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jay Lee个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/06/sql语句/" itemprop="url">记录常用 Mysql 语句</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-06T19:15:39+08:00">
                2020-07-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="常用-Mysql-语句"><a href="#常用-Mysql-语句" class="headerlink" title="常用 Mysql 语句"></a>常用 Mysql 语句</h1><blockquote>
<p>环境变量中，如果配置mysql, 直接在mysql中： <code>mysql -h localhost -u root -p</code> 输入密码即可在控制台使用mysql。</p>
</blockquote>
<h2 id="1-事务"><a href="#1-事务" class="headerlink" title="1. 事务"></a>1. 事务</h2><h3 id="1-1-ACID"><a href="#1-1-ACID" class="headerlink" title="1.1 ACID"></a>1.1 ACID</h3><h4 id="1-1-1-A-Atomicity-原子性"><a href="#1-1-1-A-Atomicity-原子性" class="headerlink" title="1.1.1 A(Atomicity) 原子性"></a>1.1.1 A(Atomicity) 原子性</h4><ul>
<li>原子性是整个数据库事务是不可分割的工作单位，只有事务中的所有的数据库操作都执行成功，才算整个事务成功。</li>
<li>要么都成功，要么都失败。</li>
</ul>
<h4 id="1-1-2-C-Consistency-一致性"><a href="#1-1-2-C-Consistency-一致性" class="headerlink" title="1.1.2 C(Consistency) 一致性"></a>1.1.2 C(Consistency) 一致性</h4><ul>
<li>一致性是指事务将数据库从一种一致性状态变为下一种一致性状态。在事务开始之前和之后，数据库的完整性约束没有被破坏。</li>
<li>银行转账前后， 两个账户的金额总数不会改变。</li>
</ul>
<h4 id="1-1-3-I-Isolation-隔离性"><a href="#1-1-3-I-Isolation-隔离性" class="headerlink" title="1.1.3 I(Isolation) 隔离性"></a>1.1.3 I(Isolation) 隔离性</h4><ul>
<li>隔离性要求每个读写事务对其他事务的操作对象能相互分离。</li>
<li>其他人的转账不能影响 A 给 B 转账。</li>
</ul>
<h4 id="1-1-4-D-Durability-持久性"><a href="#1-1-4-D-Durability-持久性" class="headerlink" title="1.1.4 D(Durability) 持久性"></a>1.1.4 D(Durability) 持久性</h4><ul>
<li>持久性指事务一旦提交，其结果就是永久性的。</li>
<li>转账成功之后，金额不会再发生改变。</li>
</ul>
<h3 id="1-2-隔离级别"><a href="#1-2-隔离级别" class="headerlink" title="1.2 隔离级别"></a>1.2 隔离级别</h3><blockquote>
<p>==mysql默认的隔离级别为可重复读，oracle的默认隔离级别为读已提交。==</p>
</blockquote>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200711173615115.png" alt="image-20200711173615115"></p>
<h4 id="1-2-1-脏读"><a href="#1-2-1-脏读" class="headerlink" title="1.2.1 脏读"></a>1.2.1 脏读</h4><p>​        ==脏读==就是指当一个事务正在访问数据，并且对数据进行了修改，而这种修改还没有提交到数据库中，这时，另外一个事务也访问这个数据(==已修改==)，然后使用了这个数据。</p>
<h4 id="1-2-2-不可重复读"><a href="#1-2-2-不可重复读" class="headerlink" title="1.2.2 不可重复读"></a>1.2.2 不可重复读</h4><p>​        不可重复读:是指在一个事务内，多次读同一数据。在这个事务还没有结束时，另外一个事务也访问该同一数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改，那么第一个事务两次读到的的数据可能是不一样的。这样就发生了在一个事务内两次读到的数据是不一样的，因此称为是不可重复读。</p>
<h4 id="1-2-3-可重复读"><a href="#1-2-3-可重复读" class="headerlink" title="1.2.3 可重复读"></a>1.2.3 可重复读</h4><p>​        可重复读是指同一个事务里面，读取同一行数据不会因为外部的事务修改了，而改变，也就是同一个事务里面，所有的数据怎么读都是同一个状态的，不受外部影响， <strong>这个也是Innodb默认的事务隔离级别</strong>。</p>
<h4 id="1-2-4-幻读"><a href="#1-2-4-幻读" class="headerlink" title="1.2.4 幻读"></a>1.2.4 幻读</h4><p>​        幻读是在可重复读隔离级别下产生的，可重复读级别，虽然外部事务的修改和插入数据不会影响到本事务查看数据， 别入外部事务修改和插入了数据，本事务是看不到的。 虽然没影响到事务的查看数据，但是，当本事务是需要插入数据和更新数据的时候，就会被外部事务的修改而影响到。</p>
<blockquote>
<p>幻读实际上就是因为可重复读，产生的 ==本事务得到的数据与实际数据不一致==，当本事务对数据进行修改时，修改影响的是实际的数据，因此造成了幻读。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 查看 隔离级别</span><br><span class="line">SELECT @@transaction_isolation</span><br><span class="line"># 设置隔离级别(mysql 默认 可重复读)</span><br><span class="line">set session transaction isolation level repeatable read</span><br><span class="line"># 设置全局系统隔离级别</span><br><span class="line">SET GLOBAL TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-锁操作"><a href="#1-3-锁操作" class="headerlink" title="1.3 锁操作"></a>1.3 锁操作</h3><h4 id="1-3-1-并发控制"><a href="#1-3-1-并发控制" class="headerlink" title="1.3.1 并发控制"></a>1.3.1 并发控制</h4><ul>
<li><p>==共享锁== 也称为读锁，读锁允许多个连接可以同一时刻并发的读取同一资源,互不干扰；</p>
</li>
<li><p>==排他锁==也称为写锁、独占锁、X锁，一个写锁会阻塞其他的写锁或读锁，保证同一时刻只有一个连接可以写入数据，同时防止其他用户对这个数据的读写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 共享锁</span><br><span class="line">select * from tableName where... lock in share mode;</span><br><span class="line"># 排他锁</span><br><span class="line">select * from tableName where... for update;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h4 id="1-3-2-锁策略"><a href="#1-3-2-锁策略" class="headerlink" title="1.3.2 锁策略"></a>1.3.2 锁策略</h4><ul>
<li>talbe lock(表锁) : mysql最基本的锁策略，也是开销最小的锁，它会锁定整个表；</li>
<li>row lock(行锁)： 可以最大限度的支持并发处理，当然也带来了最大开销，顾名思义，行锁的粒度实在每一条行数据。</li>
</ul>
<h3 id="1-4-事务语句"><a href="#1-4-事务语句" class="headerlink" title="1.4 事务语句"></a>1.4 事务语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 开始事务</span><br><span class="line">start transaction / begin</span><br><span class="line"># 执行语句</span><br><span class="line">select / update / delete / </span><br><span class="line"># 提交事务或者回滚</span><br><span class="line">commit / rollback</span><br></pre></td></tr></table></figure>

<h2 id="2-删除语句"><a href="#2-删除语句" class="headerlink" title="2. 删除语句"></a>2. 删除语句</h2><blockquote>
<p>删除整个表格， 包括结构</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># drop语句将删除表的结构，以及被依赖的约束(constrain),触发器(trigger),索引(index);</span><br><span class="line">drop table table_name;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>删除表格数据，但保留数据结构</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># truncate 将表格恢复到初始状态, 不支持事务</span><br><span class="line">truncate table table_name;</span><br><span class="line"># delete 支持事务</span><br><span class="line">delete from table_name [where ...];</span><br></pre></td></tr></table></figure>

<h2 id="3-更新语句"><a href="#3-更新语句" class="headerlink" title="3. 更新语句"></a>3. 更新语句</h2><h3 id="3-1-update"><a href="#3-1-update" class="headerlink" title="3.1 update"></a>3.1 update</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update table_name set col_name = value [where 条件]</span><br></pre></td></tr></table></figure>

<h3 id="3-2-alter"><a href="#3-2-alter" class="headerlink" title="3.2 alter"></a>3.2 alter</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 命令格式</span><br><span class="line">alter table 表名 add 字段 类型 其他;</span><br><span class="line">alter table 表名 drop 字段;</span><br><span class="line">ALTER TABLE course modify column `id` int(10) auto_increment;</span><br><span class="line"># 设置自增值</span><br><span class="line">alter table table_name AUTO_INCREMENT = 100;</span><br><span class="line"># 修改表名称</span><br><span class="line">alter table table_name rename to new_name;</span><br></pre></td></tr></table></figure>

<h2 id="4-建表语句"><a href="#4-建表语句" class="headerlink" title="4. 建表语句"></a>4. 建表语句</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table `role`(</span><br><span class="line">	`id` int(10) not null auto_increment,</span><br><span class="line">	`name` VARCHAR(64),</span><br><span class="line">	`nameZh` VARCHAR(64),</span><br><span class="line">	PRIMARY key (`id`[,`name`])</span><br><span class="line">)ENGINE=INNODB, CHARSET=&apos;utf8&apos;</span><br></pre></td></tr></table></figure>

<h3 id="4-1查看建表语句"><a href="#4-1查看建表语句" class="headerlink" title="4.1查看建表语句"></a>4.1查看建表语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 查看建表 create 语句</span><br><span class="line">show create table + 表名</span><br></pre></td></tr></table></figure>

<h2 id="5-insert"><a href="#5-insert" class="headerlink" title="5. insert"></a>5. insert</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 不设置对应字段则代表全部</span><br><span class="line">insert into table_name (field1, field2) values </span><br><span class="line">(field1_value,field2_value), (field1_value2,field1_value2)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"># 插入语句 teacher表</span><br><span class="line">INSERT into teacher (name, PASSWORD, id_card, age, college_id, mobile,</span><br><span class="line">address, birth, gender, is_acdemic, title_id, title_name, title_nameZh) VALUES</span><br><span class="line">(&apos;苏宙吉&apos;, &apos;$10$sZ6Q0l6Z74fi/vOCzGE.hu3d8kSxx6WHMDykWGMp6rYoUPdaUfm6m&apos;, </span><br><span class="line">&apos;44010319690101288X&apos;, 10, 1, &apos;18038337142&apos;, </span><br><span class="line">&apos;广东省广州市&apos;, &apos;1969-01-01&apos;, 0, 0, 3, &apos;teacher&apos;, &apos;教师&apos;),</span><br><span class="line"></span><br><span class="line"># 插入语句 student表</span><br><span class="line">INSERT into student (name, PASSWORD, id_card, age, college_id, major_id, class_id,</span><br><span class="line"> mobile,address, birth, gender, admission_time) VALUES</span><br><span class="line">(&apos;钟伟凤&apos;, &apos;$10$sZ6Q0l6Z74fi/vOCzGE.hu3d8kSxx6WHMDykWGMp6rYoUPdaUfm6m&apos;,&apos;440114196901014606&apos;, 10, 1, 1, 1,&apos;13354691421&apos;, &apos;广东省云浮市&apos;, &apos;1969-01-01&apos;, 0, &apos;2015-09-01&apos;)</span><br><span class="line"></span><br><span class="line"># 修改 生日和年龄 步骤2</span><br><span class="line">update teacher as t INNER JOIN</span><br><span class="line">(select t_id,</span><br><span class="line">CONCAT(subString(id_card,7,4), &apos;-&apos;, subString(id_card,11,2), &apos;-&apos;, subString(id_card,13,2)) as birth,</span><br><span class="line">2020 - subString(id_card,7,4) as age</span><br><span class="line">from teacher) as b on b.t_id = t.t_id </span><br><span class="line">set t.birth = b.birth, t.age = b.age</span><br><span class="line"># 修改地址</span><br><span class="line">update teacher as t INNER JOIN</span><br><span class="line">(select id, `name`</span><br><span class="line">from area) as b on substr(id_card, 1, 6) = b.id</span><br><span class="line">set t.address = b.name</span><br><span class="line"></span><br><span class="line">#修改性别</span><br><span class="line"></span><br><span class="line"># 修改身份证 步骤1</span><br><span class="line">update teacher as t1 INNER JOIN</span><br><span class="line">(select t_id,</span><br><span class="line">concat( subString(id_card,1,6),</span><br><span class="line">concat(subString(id_card,7,2), FLOOR( 7 + RAND()*2), floor( 1 + RAND()*9) ) ,</span><br><span class="line">if(floor(RAND()*2) = 0, CONCAT(&apos;0&apos;, floor(RAND()*9)+1), CONCAT(&apos;1&apos;,floor(RAND()*3))),</span><br><span class="line">if(floor(RAND()*2) = 0, CONCAT(&apos;0&apos;, floor(RAND()*9)+1), if(floor(RAND()*2) = 1, CONCAT(&apos;1&apos;, floor(RAND()*10)), if(floor(RAND()*2) = 2, CONCAT(&apos;2&apos;, floor(RAND()*10)), CONCAT(&apos;30&apos;)))), </span><br><span class="line"> subString(id_card,15,4) )as birth</span><br><span class="line"> from teacher) as t2 on t1.t_id = t2.t_id </span><br><span class="line">set t1.id_card = t2.birth  where t1.t_id &gt;= 39 </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"> # 身份证 姓名</span><br><span class="line"> .replace(/\s/g, &apos;&apos;).replace(/(4401\d&#123;14&#125;)|(4401\d&#123;13&#125;X)/g,(name) =&gt; &#123;return name + &apos; &apos;&#125;).split(&quot; &quot;)</span><br><span class="line"> </span><br><span class="line"> # 手机号码</span><br><span class="line">.replace(/\d&#123;11&#125;/g, name =&gt; &#123;return name + &quot; &quot;&#125;).trim().split(&quot; &quot;)</span><br><span class="line"></span><br><span class="line"># 循环</span><br><span class="line">var i = 0; var j = 0;var res = [];</span><br><span class="line">for(let k = 0; k &lt; data.length / 2 - 1; k++) &#123;</span><br><span class="line">    res[k] = &quot;&apos;&quot;+data[i] + &quot;&apos;, &apos;$10$sZ6Q0l6Z74fi/vOCzGE.hu3d8kSxx6WHMDykWGMp6rYoUPdaUfm6m&apos;,&apos;&quot;+ data[i+1]+&quot;&apos;, 10, 4,&apos;&quot;+m[j]+&quot;&apos;, &apos;广东省广州市&apos;, &apos;1969-01-01&apos;, 0, 0, 3, &apos;teacher&apos;, &apos;教师&apos;&quot;;</span><br><span class="line">i = i + 2;</span><br><span class="line">j = j + 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 输出 console</span><br><span class="line">res.forEach((item) =&gt; &#123;console.log(&quot;(&quot;+ item + &quot;),&quot;)&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 循环生成班级</span><br><span class="line">drop procedure if exists addClass;</span><br><span class="line">create procedure addClass() </span><br><span class="line">begin</span><br><span class="line">    declare i int default 15;  -- default 是指定该变量的默认值</span><br><span class="line">    declare j int default 1;</span><br><span class="line">while i &lt;= 18 DO -- 循环开始</span><br><span class="line">		WHILE j &lt;= 3 DO</span><br><span class="line">			INSERT into `class`(name, t_id, s_id, c_id,m_id) select CONCAT(major_nameZh, i,&quot;(&quot;, j, &quot;)班&quot;), 1, 1, college_id, major_id from university;</span><br><span class="line">			alter table `class` AUTO_INCREMENT = 1;</span><br><span class="line">			set j=j+1;</span><br><span class="line">		end while;</span><br><span class="line">    set i=i+1;</span><br><span class="line">    set j = 1;</span><br><span class="line">end while; -- 循环结束</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">call addClass();</span><br><span class="line">	</span><br><span class="line"># course 课程表</span><br><span class="line">into `course` (name, teacher_id, credit, semester, time, address, class_id, week_num)</span><br><span class="line"></span><br><span class="line"># 设置各个学院第一个老师为领导</span><br><span class="line">update teacher as t1 INNER JOIN</span><br><span class="line">(select t_id, college_id, COUNT(college_id) from teacher group by college_id) as t2</span><br><span class="line">ON t1.t_id = t2.t_id</span><br><span class="line">set is_leader = 1</span><br></pre></td></tr></table></figure>

<h2 id="6-字符串截取"><a href="#6-字符串截取" class="headerlink" title="6. 字符串截取"></a>6. 字符串截取</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># id_card 12155454656454</span><br><span class="line">select substring(id_card,4,5) from users; # 54546</span><br><span class="line"># idcard  1234335435433453</span><br><span class="line">select substr(idcard,7,4) as user_bir from users where id=2;# 543</span><br><span class="line"></span><br><span class="line"># substring_index(字段，delim,count); delim--截取数据依据的字符，count-截取字符的位置N</span><br><span class="line">SELECT SUBSTRING_INDEX(‘192,168,8,203’,’,’,1);</span><br><span class="line"># 得到结果为： 192</span><br><span class="line"> </span><br><span class="line"># N为负数时</span><br><span class="line">SELECT SUBSTRING_INDEX(‘192,168,8,203’,’,’,-1);</span><br><span class="line"># 得到结果为： 203</span><br></pre></td></tr></table></figure>

<h2 id="7-循环语句"><a href="#7-循环语句" class="headerlink" title="7 循环语句"></a>7 循环语句</h2><blockquote>
<p>mysql 的三种循环</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"># while 循环</span><br><span class="line">drop procedure if exists sum1</span><br><span class="line">create procedure sum1(a int) </span><br><span class="line">begin</span><br><span class="line">    declare sum int default 0;  -- default 是指定该变量的默认值</span><br><span class="line">    declare i int default 1;</span><br><span class="line">while i&lt;=a DO -- 循环开始</span><br><span class="line">    set sum=sum+i;</span><br><span class="line">    set i=i+1;</span><br><span class="line">end while; -- 循环结束</span><br><span class="line">select sum;  -- 输出结果</span><br><span class="line">end</span><br><span class="line">-- 执行存储过程</span><br><span class="line">call sum1(100);</span><br><span class="line">-- 删除存储过程</span><br><span class="line">drop procedure if exists sum1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># lopp 循环</span><br><span class="line">create procedure sum2(a int)</span><br><span class="line">begin</span><br><span class="line">        declare sum int default 0;</span><br><span class="line">        declare i int default 1;</span><br><span class="line">        loop_name:loop -- 循环开始</span><br><span class="line">            if i&gt;a then </span><br><span class="line">                leave loop_name;  -- 判断条件成立则结束循环  好比java中的 boeak</span><br><span class="line">            end if;</span><br><span class="line">            set sum=sum+i;</span><br><span class="line">            set i=i+1;</span><br><span class="line">        end loop;  -- 循环结束</span><br><span class="line">        select sum; -- 输出结果</span><br><span class="line">end</span><br><span class="line">-- 执行存储过程</span><br><span class="line">call sum2(100);</span><br><span class="line">-- 删除存储过程</span><br><span class="line">drop procedure if exists  sum2</span><br><span class="line"></span><br><span class="line"># repeat 循环</span><br><span class="line">create procedure sum3(a int)</span><br><span class="line">begin</span><br><span class="line">        declare sum int default 0;</span><br><span class="line">        declare i int default 1;</span><br><span class="line">        repeat -- 循环开始</span><br><span class="line">            set sum=sum+i;</span><br><span class="line">            set i=i+1;</span><br><span class="line">        until i&gt;a end repeat; -- 循环结束</span><br><span class="line">        select sum; -- 输出结果</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">-- 执行存储过程</span><br><span class="line">call sum3(100);</span><br><span class="line">-- 删除存储过程</span><br><span class="line">drop procedure if exists sum3</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/06/集错笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jay Lee">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jay Lee个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/06/集错笔记/" itemprop="url">常犯错误集锦</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-06T18:48:38+08:00">
                2020-07-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="收集平时常犯的错误"><a href="#收集平时常犯的错误" class="headerlink" title="收集平时常犯的错误"></a>收集平时常犯的错误</h1><h2 id="1-mysql-篇"><a href="#1-mysql-篇" class="headerlink" title="1. mysql 篇"></a>1. mysql 篇</h2><h3 id="1-1-将-反引号-和-单引号-‘’-搞混"><a href="#1-1-将-反引号-和-单引号-‘’-搞混" class="headerlink" title="1.1 将 反引号`` 和 单引号 ‘’ 搞混"></a>1.1 将 反引号`` 和 单引号 ‘’ 搞混</h3><ul>
<li>[Err] 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘<code>userId</code></li>
</ul>
<p>解决： 将 反引号`` 改为 单引号 ‘’ 即可</p>
<h2 id="2-springboot"><a href="#2-springboot" class="headerlink" title="2. springboot"></a>2. springboot</h2><h3 id="2-1-在使用-boolean-变量如enabled时，由于继承了UserDetails-所以同时存在is和get方法，报错如下"><a href="#2-1-在使用-boolean-变量如enabled时，由于继承了UserDetails-所以同时存在is和get方法，报错如下" class="headerlink" title="2.1 在使用 boolean 变量如enabled时，由于继承了UserDetails, 所以同时存在is和get方法，报错如下"></a>2.1 在使用 boolean 变量如enabled时，由于继承了UserDetails, 所以同时存在is和get方法，报错如下</h3><ul>
<li>com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Problem deserializing ‘setterless’ property ‘authorities’: get method returned null</li>
</ul>
<p>解决： 删除掉其中一个就好了。</p>
<h3 id="2-2-Map-直接强转对象时报错：java-lang-ClassCastException-java-util-LinkedHashMap-cannot-be-cast-to-XXX"><a href="#2-2-Map-直接强转对象时报错：java-lang-ClassCastException-java-util-LinkedHashMap-cannot-be-cast-to-XXX" class="headerlink" title="2.2 Map 直接强转对象时报错：java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to XXX,"></a>2.2 Map 直接强转对象时报错：java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to XXX,</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解决办法 利用 Object.mapper convertValue方法</span></span><br><span class="line"><span class="comment">// 同样适用于其他类型的转换</span></span><br><span class="line">ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">User user = mapper.convertValue(map.get(<span class="string">"user"</span>), <span class="keyword">new</span> TypeReference&lt;User&gt;() &#123; &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="2-3-在response-设置-header字段，返回到前端都变成了小写"><a href="#2-3-在response-设置-header字段，返回到前端都变成了小写" class="headerlink" title="2.3 在response 设置 header字段，返回到前端都变成了小写"></a>2.3 在response 设置 header字段，返回到前端都变成了小写</h3><ul>
<li>http header 不区分大小写。</li>
</ul>
<h3 id="2-4-使用ConfigurationProperties注解，报错Not-registered-via-EnableConfigurationProperties-or-marked-as-Spring-component"><a href="#2-4-使用ConfigurationProperties注解，报错Not-registered-via-EnableConfigurationProperties-or-marked-as-Spring-component" class="headerlink" title="2.4 使用ConfigurationProperties注解，报错Not registered via @EnableConfigurationProperties or marked as Spring component"></a>2.4 使用ConfigurationProperties注解，报错Not registered via @EnableConfigurationProperties or marked as Spring component</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 方法一： pom.xml加入依赖  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 方法二：修改启动类上的EnableConfigurationProperties，括号内填出现问题的类名  --&gt;</span></span><br><span class="line">@EnableConfigurationProperties(XXX.class)</span><br></pre></td></tr></table></figure>

<h3 id="2-5-在swagger中使用多文件传输时，报错-Current-request-is-not-a-multipart-request"><a href="#2-5-在swagger中使用多文件传输时，报错-Current-request-is-not-a-multipart-request" class="headerlink" title="2.5 在swagger中使用多文件传输时，报错 Current request is not a multipart request"></a>2.5 在swagger中使用多文件传输时，报错 Current request is not a multipart request</h3><ul>
<li>由于 request header 的默认设置为 application/json， 在该方法上的注解加入 headers = “content-type=multipart/form-data”即可</li>
<li>@PostMapping(value = “/uploadMultipleFiles”,headers = “content-type=multipart/form-data”)</li>
<li>上述解决了接口报错，但是swagger在接收时 files 参数为空，直接用==postman==调试即可。</li>
</ul>
<h2 id="3-vue"><a href="#3-vue" class="headerlink" title="3. vue"></a>3. vue</h2><h3 id="3-1-在表单自定义规则时，-不会进入下图所示的debugger"><a href="#3-1-在表单自定义规则时，-不会进入下图所示的debugger" class="headerlink" title="3.1  在表单自定义规则时， 不会进入下图所示的debugger"></a>3.1  在表单自定义规则时， 不会进入下图所示的debugger</h3><p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200708140333203.png" alt="image-20200708140333203"></p>
<p>解决办法： 自定义规则的所有情况，都需要确保每一种情况都有 callback 回调。</p>
<h2 id="4-redis"><a href="#4-redis" class="headerlink" title="4. redis"></a>4. redis</h2><h3 id="4-1-Redis-报错-java-net-SocketTimeoutException-Read-timed-out-nested-exception-is-redis-clients-jedis-exceptions"><a href="#4-1-Redis-报错-java-net-SocketTimeoutException-Read-timed-out-nested-exception-is-redis-clients-jedis-exceptions" class="headerlink" title="4.1  Redis 报错 java.net.SocketTimeoutException: Read timed out; nested exception is redis.clients.jedis.exceptions"></a>4.1  Redis 报错 java.net.SocketTimeoutException: Read timed out; nested exception is redis.clients.jedis.exceptions</h3><ul>
<li>解决方法： 启动时记得加上 redis.windows.conf 配置文件  </li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Jay Lee</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jay Lee</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
